<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M√¥ ph·ªèng Dao ƒë·ªông T·∫Øt d·∫ßn</title>
    <script src="https://cdn.tailwindcss.com"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']], // B·∫Øt bu·ªôc nh·∫≠n di·ªán $...$
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      },
      // ...
    };
    </script>

    <style>
        body {
            background-color: #f0f2f5;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }
        canvas {
            background: white;
            border-radius: 8px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
        }
        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
            font-size: 0.875rem;
            font-weight: 500;
        }
        input[type="range"] {
            width: 100%;
            margin-bottom: 16px;
        }
        .scrollable-content {
            overflow-y: auto;
            flex-grow: 1;
        }
        .tab-btn.active {
            border-bottom: 2px solid #2563eb;
            color: #2563eb;
        }
    </style>
</head>
<body class="h-screen flex flex-col p-4">
    <header class="mb-4">
        <h1 class="text-2xl font-bold text-gray-800 text-center">Th√≠ nghi·ªám Dao ƒë·ªông T·∫Øt d·∫ßn</h1>
    </header>

    <div class="flex flex-1 gap-4 overflow-hidden">
        <!-- Panel Tr√°i: B·∫£ng ƒëi·ªÅu khi·ªÉn v·ªõi TABS -->
        <aside class="w-96 bg-white rounded-xl shadow-lg flex flex-col overflow-hidden">
            <!-- Tab Headers -->
            <div class="flex border-b">
                <button id="tabControls" class="tab-btn active flex-1 py-3 font-semibold text-sm transition">ƒêi·ªÅu khi·ªÉn</button>
                <button id="tabTheory" class="tab-btn flex-1 py-3 font-semibold text-sm transition text-gray-500">Nh·∫≠n x√©t & L√Ω thuy·∫øt</button>
            </div>

            <!-- Tab Content: Controls -->
            <div id="contentControls" class="p-6 flex flex-col gap-4 scrollable-content">
                <section>
                    <h2 class="text-lg font-semibold mb-4 text-gray-700">Th√¥ng s·ªë v·∫≠t l√Ω</h2>
                    
                    <div>
                        <div class="slider-label">
                            <span>Kh·ªëi l∆∞·ª£ng (m):</span>
                            <span id="mVal" class="text-blue-600">1.0</span> kg
                        </div>
                        <input type="range" id="mSlider" min="0.5" max="5" step="0.1" value="1">
                    </div>

                    <div>
                        <div class="slider-label">
                            <span>ƒê·ªô c·ª©ng (k):</span>
                            <span id="kVal" class="text-blue-600">10.0</span> N/m
                        </div>
                        <input type="range" id="kSlider" min="5" max="50" step="1" value="10">
                    </div>

                    <div>
                        <div class="slider-label">
                            <span>H·ªá s·ªë c·∫£n (b):</span>
                            <span id="bVal" class="text-blue-600">0.5</span> Ns/m
                        </div>
                        <input type="range" id="bSlider" min="0" max="30" step="0.1" value="0.5">
                    </div>

                    <div class="mt-4 p-4 bg-blue-50 rounded-lg border border-blue-100">
                        <h3 class="font-bold text-blue-800 mb-2">Tr·∫°ng th√°i h·ªá th·ªëng:</h3>
                        <div id="statusText" class="text-sm font-bold">ƒêang t√≠nh to√°n...</div>
                        <div id="zetaVal" class="text-xs text-blue-600 mt-1">Œ∂ = 0.00</div>
                    </div>

                    <div class="mt-6 grid grid-cols-3 gap-2">
                        <button id="playBtn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 rounded shadow transition text-xs uppercase tracking-wider">
                            Ph√°t
                        </button>
                        <button id="stopBtn" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 rounded shadow transition text-xs uppercase tracking-wider">
                            D·ª´ng
                        </button>
                        <button id="resetBtn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 rounded shadow transition text-xs uppercase tracking-wider">
                            L√†m m·ªõi
                        </button>
                    </div>
                </section>
            </div>

            <!-- Tab Content: Theory/Remarks -->
            <div id="contentTheory" class="p-6 hidden flex flex-col gap-4 scrollable-content">
                <h2 class="text-lg font-semibold border-b pb-2 mb-2 text-gray-700">Gi·∫£i th√≠ch k·∫øt qu·∫£</h2>
                
                <div class="text-sm space-y-4 text-gray-600 leading-relaxed">
                    <div>
                        <p class="font-bold text-blue-700">1. Nguy√™n nh√¢n t·∫Øt d·∫ßn:</p>
                        <p>Do ma s√°t v√† l·ª±c c·∫£n m√¥i tr∆∞·ªùng l√†m ti√™u t√°n c∆° nƒÉng th√†nh nhi·ªát nƒÉng.</p>
                        <ul class="list-disc ml-4 mt-2 space-y-2 text-xs">
                            <li class="p-1 rounded bg-blue-50 border-l-4 border-blue-400">
                                <strong>D∆∞·ªõi h·∫°n ($\zeta < 1$):</strong> L·ª±c c·∫£n y·∫øu. V·∫≠t dao ƒë·ªông v·ªõi bi√™n ƒë·ªô gi·∫£m d·∫ßn. C√†ng g·∫ßn 1, v·∫≠t d·ª´ng c√†ng nhanh.
                            </li>
                            <li class="p-1 rounded bg-green-50 border-l-4 border-green-400">
                                <strong>T·ªõi h·∫°n ($\zeta \approx 1$):</strong> Tr·∫°ng th√°i l√Ω t∆∞·ªüng. V·∫≠t v·ªÅ v·ªã tr√≠ c√¢n b·∫±ng nhanh nh·∫•t m√† kh√¥ng b·ªã l·ªách sang b√™n ƒë·ªëi di·ªán.
                            </li>
                            <li class="p-1 rounded bg-red-50 border-l-4 border-red-400">
                                <strong>V∆∞·ª£t h·∫°n ($\zeta > 1$):</strong> L·ª±c c·∫£n qu√° m·∫°nh (nh∆∞ trong d·∫ßu ƒë·∫∑c). V·∫≠t tr∆∞·ª£t v·ªÅ c·ª±c k·ª≥ ch·∫≠m.
                            </li>
                        </ul>
                    </div>

                    <div class="bg-gray-50 p-3 rounded-lg">
                        <p class="font-bold text-gray-700 mb-1">2. ƒê·∫∑c ƒëi·ªÉm bi·∫øn ƒë·ªïi:</p>
                        <ul class="list-none space-y-2 text-xs">
                            <li><span class="font-semibold">üìè Bi√™n ƒë·ªô:</span> Gi·∫£m theo quy lu·∫≠t h√†m m≈© ƒë·ªëi v·ªõi dao ƒë·ªông d∆∞·ªõi h·∫°n.</li>
                            <li><span class="font-semibold">üîã C∆° nƒÉng:</span> Kh√¥ng b·∫£o to√†n, lu√¥n gi·∫£m theo th·ªùi gian.</li>
                            <li><span class="font-semibold">‚è±Ô∏è Chu k·ª≥ & T·∫ßn s·ªë:</span> Khi l·ª±c c·∫£n tƒÉng, chu k·ª≥ $T$ c·ªßa dao ƒë·ªông th·ª±c t·∫ø s·∫Ω l·ªõn h∆°n chu k·ª≥ dao ƒë·ªông t·ª± do.</li>
                        </ul>
                    </div>
                    
                    <p class="text-[10px] text-gray-400 italic">* L∆∞u √Ω: Trong ƒë·ªì th·ªã, tr·ª•c ngang l√† th·ªùi gian (s), tr·ª•c d·ªçc l√† li ƒë·ªô x (cm).</p>
                </div>
            </div>
        </aside>

        <!-- Panel Ph·∫£i: M√¥ ph·ªèng v√† ƒê·ªì th·ªã -->
        <main class="flex-1 flex flex-col gap-4">
            <div class="h-1/3 flex gap-4">
                <div class="flex-1 flex flex-col">
                    <span class="text-sm font-bold text-gray-600 mb-1">Con l·∫Øc l√≤ xo</span>
                    <canvas id="simCanvasSpring" class="flex-1"></canvas>
                </div>
                <div class="flex-1 flex flex-col">
                    <span class="text-sm font-bold text-gray-600 mb-1">Con l·∫Øc ƒë∆°n</span>
                    <canvas id="simCanvasPendulum" class="flex-1"></canvas>
                </div>
            </div>
            
            <div class="flex-1 flex flex-col">
                <span class="text-sm font-bold text-gray-600 mb-1">ƒê·ªì th·ªã Li ƒë·ªô - Th·ªùi gian x(t)</span>
                <canvas id="graphCanvas" class="flex-1"></canvas>
            </div>
        </main>
    </div>

    <script>
        // Tab switching logic
        const tabControls = document.getElementById('tabControls');
        const tabTheory = document.getElementById('tabTheory');
        const contentControls = document.getElementById('contentControls');
        const contentTheory = document.getElementById('contentTheory');

        tabControls.addEventListener('click', () => {
            tabControls.classList.add('active', 'text-blue-600');
            tabTheory.classList.remove('active', 'text-blue-600');
            tabTheory.classList.add('text-gray-500');
            contentControls.classList.remove('hidden');
            contentTheory.classList.add('hidden');
        });

        tabTheory.addEventListener('click', () => {
            tabTheory.classList.add('active', 'text-blue-600');
            tabControls.classList.remove('active', 'text-blue-600');
            tabControls.classList.add('text-gray-500');
            contentTheory.classList.remove('hidden');
            contentControls.classList.add('hidden');
        });

        // Simulation Canvas setup
        const simCanvasSpring = document.getElementById('simCanvasSpring');
        const simCanvasPendulum = document.getElementById('simCanvasPendulum');
        const graphCanvas = document.getElementById('graphCanvas');
        
        const ctxSpring = simCanvasSpring.getContext('2d');
        const ctxPendulum = simCanvasPendulum.getContext('2d');
        const ctxGraph = graphCanvas.getContext('2d');

        const mSlider = document.getElementById('mSlider');
        const kSlider = document.getElementById('kSlider');
        const bSlider = document.getElementById('bSlider');
        const mValDisp = document.getElementById('mVal');
        const kValDisp = document.getElementById('kVal');
        const bValDisp = document.getElementById('bVal');
        const statusText = document.getElementById('statusText');
        const zetaDisp = document.getElementById('zetaVal');
        
        const playBtn = document.getElementById('playBtn');
        const stopBtn = document.getElementById('stopBtn');
        const resetBtn = document.getElementById('resetBtn');

        // Physics State
        let m = 1.0;
        let k = 10.0;
        let b = 0.5;
        let x0 = 80; 
        let time = 0;
        let history = [];
        let isRunning = true;
        const dt = 0.016; 

        function resize() {
            simCanvasSpring.width = simCanvasSpring.clientWidth;
            simCanvasSpring.height = simCanvasSpring.clientHeight;
            simCanvasPendulum.width = simCanvasPendulum.clientWidth;
            simCanvasPendulum.height = simCanvasPendulum.clientHeight;
            graphCanvas.width = graphCanvas.clientWidth;
            graphCanvas.height = graphCanvas.clientHeight;
        }

        window.addEventListener('resize', resize);
        resize();

        function updateParams() {
            m = parseFloat(mSlider.value);
            k = parseFloat(kSlider.value);
            b = parseFloat(bSlider.value);
            
            mValDisp.innerText = m.toFixed(1);
            kValDisp.innerText = k.toFixed(1);
            bValDisp.innerText = b.toFixed(1);

            const omega0 = Math.sqrt(k / m);
            const zeta = b / (2 * Math.sqrt(m * k));
            zetaDisp.innerHTML = `H·ªá s·ªë c·∫£n t∆∞∆°ng ƒë·ªëi &zeta; = ${zeta.toFixed(3)}`;

            if (zeta < 1) {
                statusText.innerText = "T·∫Øt d·∫ßn D∆Ø·ªöI H·∫†N (Underdamped)";
                statusText.className = "text-sm font-bold text-blue-600";
            } else if (Math.abs(zeta - 1) < 0.05) {
                statusText.innerText = "T·∫Øt d·∫ßn T·ªöI H·∫†N (Critically Damped)";
                statusText.className = "text-sm font-bold text-green-600";
            } else {
                statusText.innerText = "T·∫Øt d·∫ßn V∆Ø·ª¢T H·∫†N (Overdamped)";
                statusText.className = "text-sm font-bold text-red-600";
            }
        }

        function resetSim() {
            time = 0;
            history = [];
            isRunning = true;
            updateParams();
        }

        playBtn.addEventListener('click', () => isRunning = true);
        stopBtn.addEventListener('click', () => isRunning = false);
        resetBtn.addEventListener('click', resetSim);

        [mSlider, kSlider, bSlider].forEach(s => s.addEventListener('input', () => {
            updateParams();
        }));

        function getPosition(t) {
            const omega0 = Math.sqrt(k / m);
            const gamma = b / (2 * m);
            
            if (gamma < omega0) {
                const wd = Math.sqrt(omega0**2 - gamma**2);
                return x0 * Math.exp(-gamma * t) * Math.cos(wd * t);
            } else if (Math.abs(gamma - omega0) < 0.001) {
                return x0 * (1 + gamma * t) * Math.exp(-gamma * t);
            } else {
                const r1 = -gamma + Math.sqrt(gamma**2 - omega0**2);
                const r2 = -gamma - Math.sqrt(gamma**2 - omega0**2);
                const C1 = x0 * r2 / (r2 - r1);
                const C2 = -x0 * r1 / (r2 - r1);
                return C1 * Math.exp(r1 * t) + C2 * Math.exp(r2 * t);
            }
        }

        function drawSpring(ctx, x) {
            const w = ctx.canvas.width;
            const h = ctx.canvas.height;
            const centerY = h / 2;
            const startX = 40;
            const currentX = startX + 100 + x;

            ctx.clearRect(0, 0, w, h);
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(startX, centerY - 40);
            ctx.lineTo(startX, centerY + 40);
            ctx.stroke();

            ctx.strokeStyle = '#888';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(startX, centerY);
            
            const coils = 15;
            const springWidth = currentX - startX - 20;
            for(let i=0; i<=coils; i++) {
                const px = startX + (i/coils) * springWidth;
                const py = centerY + (i % 2 === 0 ? -15 : 15);
                ctx.lineTo(px, py);
            }
            ctx.lineTo(currentX - 20, centerY);
            ctx.stroke();

            ctx.fillStyle = '#3b82f6';
            ctx.beginPath();
            ctx.roundRect(currentX - 20, centerY - 20, 40, 40, 4);
            ctx.fill();
            ctx.stroke();
            
            ctx.setLineDash([5, 5]);
            ctx.strokeStyle = '#ccc';
            ctx.beginPath();
            ctx.moveTo(startX + 100, 0);
            ctx.lineTo(startX + 100, h);
            ctx.stroke();
            ctx.setLineDash([]);
        }

        function drawPendulum(ctx, x) {
            const w = ctx.canvas.width;
            const h = ctx.canvas.height;
            const centerX = w / 2;
            const startY = 20;
            const length = h - 80;
            const theta = x / 100; 

            const px = centerX + length * Math.sin(theta);
            const py = startY + length * Math.cos(theta);

            ctx.clearRect(0, 0, w, h);
            ctx.fillStyle = '#333';
            ctx.fillRect(centerX - 20, startY - 5, 40, 10);

            ctx.strokeStyle = '#666';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(centerX, startY);
            ctx.lineTo(px, py);
            ctx.stroke();

            ctx.fillStyle = '#ef4444';
            ctx.beginPath();
            ctx.arc(px, py, 15, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();

            ctx.setLineDash([5, 5]);
            ctx.strokeStyle = '#ccc';
            ctx.beginPath();
            ctx.moveTo(centerX, startY);
            ctx.lineTo(centerX, h);
            ctx.stroke();
            ctx.setLineDash([]);
        }

        function drawGraph() {
            const w = graphCanvas.width;
            const h = graphCanvas.height;
            const centerY = h / 2;
            
            ctxGraph.clearRect(0, 0, w, h);
            ctxGraph.strokeStyle = '#ddd';
            ctxGraph.beginPath();
            ctxGraph.moveTo(0, centerY);
            ctxGraph.lineTo(w, centerY);
            ctxGraph.moveTo(50, 0);
            ctxGraph.lineTo(50, h);
            ctxGraph.stroke();

            ctxGraph.fillStyle = '#999';
            ctxGraph.font = '12px Arial';
            ctxGraph.fillText("t (s)", w - 30, centerY + 20);
            ctxGraph.fillText("x (li ƒë·ªô)", 10, 20);

            if (history.length < 2) return;

            ctxGraph.strokeStyle = '#3b82f6';
            ctxGraph.lineWidth = 2;
            ctxGraph.beginPath();
            
            const timeScale = (w - 100) / 10; 
            const amplitudeScale = (h / 2 - 20) / x0;

            for (let i = 0; i < history.length; i++) {
                const point = history[i];
                const dx = 50 + point.t * timeScale;
                const dy = centerY - point.x * amplitudeScale;
                
                if (i === 0) ctxGraph.moveTo(dx, dy);
                else ctxGraph.lineTo(dx, dy);

                if (dx > w) break;
            }
            ctxGraph.stroke();
        }

        function animate() {
            if (isRunning) {
                const currentX = getPosition(time);
                if (time < 15) {
                    history.push({ t: time, x: currentX });
                }
                drawSpring(ctxSpring, currentX);
                drawPendulum(ctxPendulum, currentX);
                drawGraph();
                time += dt;
            }
            requestAnimationFrame(animate);
        }

        updateParams();
        animate();
    </script>
</body>
</html>
